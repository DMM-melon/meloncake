<!-- order/show -->
<% if flash[:notice] %>
    <p><%= flash[:notice] %></p>
<% end %>

<h2>注文詳細画面</h2>

<h4>購入者</h4>
<%= @order.customer.last_name %> <%= @order.customer.first_name %>

<h4>配送先</h4>
<%= @order.postcode + @order.address %>
<%= @order.name %>

<h4>支払方法</h4>
<%= @order.payment %>

<%= form_for [:admin, @order] do |f| %>
<h4>注文ステータス</h4>
<%= f.select :order_status, Order.order_statuses.keys.to_a, {} %>

<%= f.submit "更新" %>
<% end %>

<table class="table table-hover table-inverse">
    <thead>
    <tr>
    <th>商品名</th>
    <th>単価（税込）</th>
    <th>数量</th>
    <th>小計</th>
    <th>製作ステータス</th>
    </tr>
    </thead>

    <tbody>
    <% @order_items.each do |order_item| %>
    <tr>
        <td><%= @order_item.product.name %></td>
        <td><%= number_to_currency(@order_item.purchase_price * @tax) %></td>
        <td><%= @order_item.quantity %></td>
        <td><%= number_to_currency(@order_item.purchase_price * @tax * @order_item.quantity) %></td>
        <td><%= f.select :order_item_id, Order_item.order_item_statuses.keys.to_a %></td>
    </tr>

    </tbody>
</table>

<h4>商品合計</h4>
<%= number_to_currency(order_item.sum(:purchase_price) * @tax) %>

<h4>送料</h4>
<%= number_to_currency(@carriage) %>

<h4>請求金額合計</h4>
<%= number_to_currency(order_item.sum(:purchase_price) * @tax * @carriage ) %>

    <% end %>